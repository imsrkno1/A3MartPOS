{# This template only contains the form content for modal display #}
<div class="p-2 md:p-6"> {# Reduced padding for modal context #}
    <h1 class="text-xl font-bold text-gray-800 mb-4">{{ form_action }} Customer</h1>

     {# Flash Messages within modal if any #}
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="mb-4 space-y-2">
                {% for category, message in messages %}
                    {% set category_class = 'bg-blue-100 border-blue-500 text-blue-700' %}
                    {% if category == 'success' %}{% set category_class = 'bg-green-100 border-green-500 text-green-700' %}{% endif %}
                    {% if category == 'warning' %}{% set category_class = 'bg-yellow-100 border-yellow-500 text-yellow-700' %}{% endif %}
                    {% if category == 'danger' %}{% set category_class = 'bg-red-100 border-red-500 text-red-700' %}{% endif %}
                    <div class="border-l-4 p-3 rounded-md {{ category_class }} text-sm" role="alert"><p>{{ message }}</p></div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <form method="POST" action="{{ url_for('customers.add_customer' if form_action == 'Add' else 'customers.edit_customer', customer_id=customer.id if customer else None, context='modal') }}" novalidate>
        {{ form.hidden_tag() }} {# CSRF Token #}
        <div class="space-y-3">
            <div>
                {{ form.name.label(class="block text-sm font-medium text-gray-700 mb-1") }}
                {{ form.name(class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md py-2 px-3", placeholder="Enter customer name") }}
                {% for error in form.name.errors %}<p class="text-red-500 text-xs italic mt-1">{{ error }}</p>{% endfor %}
            </div>
            <div>
                {{ form.phone_number.label(class="block text-sm font-medium text-gray-700 mb-1") }}
                {{ form.phone_number(class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md py-2 px-3", placeholder="Optional phone number") }}
                {% for error in form.phone_number.errors %}<p class="text-red-500 text-xs italic mt-1">{{ error }}</p>{% endfor %}
            </div>
            <div>
                {{ form.email.label(class="block text-sm font-medium text-gray-700 mb-1") }}
                {{ form.email(type="email", class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md py-2 px-3", placeholder="Optional email address") }}
                {% for error in form.email.errors %}<p class="text-red-500 text-xs italic mt-1">{{ error }}</p>{% endfor %}
            </div>
            <div>
                {{ form.address.label(class="block text-sm font-medium text-gray-700 mb-1") }}
                {{ form.address(rows=2, class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border border-gray-300 rounded-md py-2 px-3", placeholder="Optional address details") }}
                {% for error in form.address.errors %}<p class="text-red-500 text-xs italic mt-1">{{ error }}</p>{% endfor %}
            </div>
        </div>
        <div class="mt-6 pt-4 border-t border-gray-200">
            <div class="flex justify-end">
                 {# For modal, cancel might be handled by modal's close button #}
                 {# <button type="button" onclick="window.parent.closeCustomerModal();" class="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">Cancel</button> #}
                {{ form.submit(value=form_action + ' Customer', class="ml-3 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 cursor-pointer") }}
            </div>
        </div>
    </form>
</div>
